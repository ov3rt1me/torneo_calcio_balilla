<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Torneo - Fase Finale</title>
<style>
body{
  font-family: Arial, Helvetica, sans-serif;
  background:#111;
  color:#fff;
  margin:0;
  padding:20px;
}
h1,h2{
  margin-top:30px;
}
.section{
  margin-bottom:40px;
}
.match{
  display:flex;
  align-items:center;
  justify-content:space-between;
  background:#1c1c1c;
  border-radius:10px;
  padding:12px 16px;
  margin:10px 0;
}
.team{
  display:flex;
  align-items:center;
  gap:10px;
  width:40%;
}
.team.right{
  justify-content:flex-end;
  text-align:right;
}
.team img{
  width:40px;
  height:40px;
  object-fit:contain;
}
.score{
  font-size:18px;
  font-weight:bold;
  padding:6px 14px;
  border-radius:20px;
  background:#333;
}
.win{
  background:#1ed760;
  color:#000;
}
.lose{
  background:#ff4d4d;
  color:#000;
}
</style>
</head>
<body>

<h1>Fase Finale</h1>

<div class="section">
  <h2>Semifinali</h2>
  <div id="semifinali"></div>
</div>

<div class="section">
  <h2>Finale</h2>
  <div id="finale"></div>
</div>

<div class="section">
  <h2>Playout (Ultimo posto)</h2>
  <div id="playout"></div>
</div>

<script>
function logo(team){
  return `loghi/${team}.png`;
}

function parseAgg(a){
  if(!a) return null;
  const m=a.match(/(\d+)-(\d+)/);
  if(!m) return null;
  return {a:+m[1], b:+m[2]};
}

fetch('result.csv')
.then(r=>r.text())
.then(t=>{
  const rows=t.split('\n').slice(1);
  rows.forEach(r=>{
    if(!r.trim()) return;
    const c=r.split(';');
    const s1=c[0], s2=c[1], agg=c[6];
    if(!s1 || !s2) return;

    const res=parseAgg(agg);
    let cls1='', cls2='', clsScore='';
    if(res){
      if(res.a>res.b){ cls1='win'; cls2='lose'; clsScore='win'; }
      if(res.b>res.a){ cls2='win'; cls1='lose'; clsScore='win'; }
    }

    const div=document.createElement('div');
    div.className='match';
    div.innerHTML=`
      <div class="team ${cls1}">
        <img src="${logo(s1)}" onerror="this.style.opacity=0.3">
        <span>${s1}</span>
      </div>
      <div class="score ${clsScore}">${agg||'-'}</div>
      <div class="team right ${cls2}">
        <span>${s2}</span>
        <img src="${logo(s2)}" onerror="this.style.opacity=0.3">
      </div>
    `;

    if(s1.startsWith('Semifinale')) document.getElementById('semifinali').appendChild(div);
    else if(s1.startsWith('Finale')) document.getElementById('finale').appendChild(div);
    else if(s1.startsWith('Playout')) document.getElementById('playout').appendChild(div);
  });
});
</script>

</body>
</html>
